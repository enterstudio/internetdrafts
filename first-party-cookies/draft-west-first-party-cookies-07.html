<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Same-site Cookies</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Goals"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Examples"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology and notation"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 &#x201C;Same-site&#x201D; and &#x201C;cross-site&#x201D; Requests"/>
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Document-based requests"/>
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 Worker-based requests"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Server Requirements"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Grammar"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Semantics of the &#x201C;SameSite&#x201D; Attribute (Non-Normative)"/>
<link href="#rfc.section.4" rel="Chapter" title="4 User Agent Requirements"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 The &#x201C;SameSite&#x201D; attribute"/>
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 &#x201C;Strict&#x201D; and &#x201C;Lax&#x201D; enforcement"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Monkey-patching the Storage Model"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Monkey-patching the &#x201C;Cookie&#x201D; header"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Authoring Considerations"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Defense in depth"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Top-level Navigations"/>
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Mashups and Widgets"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Privacy Considerations"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Server-controlled"/>
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Pervasive Monitoring"/>
<link href="#rfc.references" rel="Chapter" title="7 References"/>
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="West, M. and M. Goodwin" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-west-first-party-cookies-07" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-4-6" />
  <meta name="dct.abstract" content="This document updates RFC6265 by defining a " />
  <meta name="description" content="This document updates RFC6265 by defining a " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">HTTPbis</td>
  <td class="right">M. West</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Google, Inc</td>
</tr>
<tr>
  <td class="left">Updates: 6265 (if approved)</td>
  <td class="right">M. Goodwin</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">Mozilla</td>
</tr>
<tr>
  <td class="left">Expires: October 8, 2016</td>
  <td class="right">April 6, 2016</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Same-site Cookies<br />
  <span class="filename">draft-west-first-party-cookies-07</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document updates RFC6265 by defining a <samp>SameSite</samp> attribute which allows servers to assert that a cookie ought not to be sent along with cross-site requests. This assertion allows user agents to mitigate the risk of cross-origin information leakage, and provides some protection against cross-site request forgery attacks.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 8, 2016.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Goals</a></li>
<li>1.2.   <a href="#rfc.section.1.2">Examples</a></li>
</ul><li>2.   <a href="#rfc.section.2">Terminology and notation</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">&#8220;Same-site&#8221; and &#8220;cross-site&#8221; Requests</a></li>
<ul><li>2.1.1.   <a href="#rfc.section.2.1.1">Document-based requests</a></li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">Worker-based requests</a></li>
</ul></ul><li>3.   <a href="#rfc.section.3">Server Requirements</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Grammar</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Semantics of the &#8220;SameSite&#8221; Attribute (Non-Normative)</a></li>
</ul><li>4.   <a href="#rfc.section.4">User Agent Requirements</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">The &#8220;SameSite&#8221; attribute</a></li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">&#8220;Strict&#8221; and &#8220;Lax&#8221; enforcement</a></li>
</ul><li>4.2.   <a href="#rfc.section.4.2">Monkey-patching the Storage Model</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Monkey-patching the &#8220;Cookie&#8221; header</a></li>
</ul><li>5.   <a href="#rfc.section.5">Authoring Considerations</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Defense in depth</a></li>
<li>5.2.   <a href="#rfc.section.5.2">Top-level Navigations</a></li>
<li>5.3.   <a href="#rfc.section.5.3">Mashups and Widgets</a></li>
</ul><li>6.   <a href="#rfc.section.6">Privacy Considerations</a></li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Server-controlled</a></li>
<li>6.2.   <a href="#rfc.section.6.2">Pervasive Monitoring</a></li>
</ul><li>7.   <a href="#rfc.references">References</a></li>
<ul><li>7.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a></h1>
<p id="rfc.section.1.p.1">Section 8.2 of <a href="#RFC6265">[RFC6265]</a> eloquently notes that cookies are a form of ambient authority, attached by default to requests the user agent sends on a user&#8217;s behalf. Even when an attacker doesn&#8217;t know the contents of a user&#8217;s cookies, she can still execute commands on the user&#8217;s behalf (and with the user&#8217;s authority) by asking the user agent to send HTTP requests to unwary servers.</p>
<p id="rfc.section.1.p.2">Here, we update <a href="#RFC6265">[RFC6265]</a> with a simple mitigation strategy that allows servers to declare certain cookies as &#8220;same-site&#8221;, meaning they should not be attached to &#8220;cross-site&#8221; requests (as defined in section 2.1).</p>
<p id="rfc.section.1.p.3">Note that the mechanism outlined here is backwards compatible with the existing cookie syntax. Servers may serve these cookies to all user agents; those that do not support the <samp>SameSite</samp> attribute will simply store a cookie which is attached to all relevant requests, just as they do today.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#goals" id="goals">Goals</a></h1>
<p id="rfc.section.1.1.p.1">These cookies are intended to provide a solid layer of defense-in-depth against attacks which require embedding an authenticated request into an attacker-controlled context:</p>
<p/>

<ol>
  <li>Timing attacks which yield cross-origin information leakage (such as those detailed in <a href="#pixel-perfect">[pixel-perfect]</a>) can be substantially mitigated by setting the <samp>SameSite</samp> attribute on authentication cookies. The attacker will only be able to embed unauthenticated resources, as embedding mechanisms such as <samp>&lt;iframe&gt;</samp> will yield cross-site requests.</li>
  <li>Cross-site script inclusion (XSSI) attacks are likewise mitigated by setting the <samp>SameSite</samp> attribute on authentication cookies. The attacker will not be able to include authenticated resources via <samp>&lt;script&gt;</samp> or <samp>&lt;link&gt;</samp>, as these embedding mechanisms will likewise yield cross-site requests.</li>
  <li>Cross-site request forgery (CSRF) attacks which rely on top-level navigation (HTML <samp>&lt;form&gt;</samp> POSTs, for instance) can also be mitigated by treating these navigational requests as &#8220;cross-site&#8221;.</li>
  <li>Same-site cookies have some marginal value for policy or regulatory purposes, as cookies which are not delivered with cross-site requests cannot be directly used for tracking purposes. It may be valuable for an origin to assert that its cookies should not be sent along with cross-site requests in order to limit its exposure to non-technical risk.</li>
</ol>
<h1 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#examples" id="examples">Examples</a></h1>
<p id="rfc.section.1.2.p.1">Same-site cookies are set via the <samp>SameSite</samp> attribute in the <samp>Set-Cookie</samp> header field. That is, given a server&#8217;s response to a user agent which contains the following header field:</p>
<pre>
Set-Cookie: SID=31d4d96e407aad42; SameSite=Strict
</pre>
<p id="rfc.section.1.2.p.2">Subsequent requests from that user agent can be expected to contain the following header field if and only if both the requested resource and the resource in the top-level browsing context match the cookie.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#terminology-and-notation" id="terminology-and-notation">Terminology and notation</a></h1>
<p id="rfc.section.2.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">This specification uses the Augmented Backus-Naur Form (ABNF) notation of <a href="#RFC5234">[RFC5234]</a>.</p>
<p id="rfc.section.2.p.3">Two sequences of octets are said to case-insensitively match each other if and only if they are equivalent under the <samp>i;ascii-casemap</samp> collation defined in <a href="#RFC4790">[RFC4790]</a>.</p>
<p id="rfc.section.2.p.4">The terms &#8220;active document&#8221;, &#8220;ancestor browsing context&#8221;, &#8220;browsing context&#8221;, &#8220;document&#8221;, &#8220;WorkerGlobalScope&#8221;, &#8220;sandboxed origin browsing context flag&#8221;, &#8220;parent browsing context&#8221;, &#8220;the worker&#8217;s Documents&#8221;, &#8220;nested browsing context&#8221;, and &#8220;top-level browsing context&#8221; are defined in <a href="#HTML">[HTML]</a>.</p>
<p id="rfc.section.2.p.5">&#8220;Service Workers&#8221; are defined in the Service Workers specification <a href="#SERVICE-WORKERS">[SERVICE-WORKERS]</a>.</p>
<p id="rfc.section.2.p.6">The term &#8220;origin&#8221;, the mechanism of deriving an origin from a URI, and the &#8220;the same&#8221; matching algorithm for origins are defined in <a href="#RFC6454">[RFC6454]</a>.</p>
<p id="rfc.section.2.p.7">&#8220;Safe&#8221; HTTP methods include <samp>GET</samp>, <samp>HEAD</samp>, <samp>OPTIONS</samp>, and <samp>TRACE</samp>, as defined in Section 4.2.1 of <a href="#RFC7231">[RFC7231]</a>.</p>
<p id="rfc.section.2.p.8">The term &#8220;public suffix&#8221; is defined in a note in Section 5.3 of <a href="#RFC6265">[RFC6265]</a> as &#8220;a domain that is controlled by a public registry&#8221;. For example, <samp>example.com</samp>&#8217;s public suffix is <samp>com</samp>. User agents SHOULD use an up-to-date public suffix list, such as the one maintained by Mozilla at <a href="#PSL">[PSL]</a>.</p>
<p id="rfc.section.2.p.9">An origin&#8217;s &#8220;registrable domain&#8221; is the origin&#8217;s host&#8217;s public suffix plus the label to its left. That is, <samp>https://www.example.com</samp>&#8217;s registrable domain is <samp>example.com</samp>. This concept is defined more rigorously in <a href="#PSL">[PSL]</a>.</p>
<p id="rfc.section.2.p.10">The term &#8220;request&#8221;, as well as a request&#8217;s &#8220;client&#8221;, &#8220;current url&#8221;, &#8220;method&#8221;, and &#8220;target browsing context&#8221;, are defined in <a href="#FETCH">[FETCH]</a>.</p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#same-site-requests" id="same-site-requests">&#8220;Same-site&#8221; and &#8220;cross-site&#8221; Requests</a></h1>
<p id="rfc.section.2.1.p.1">A request is &#8220;same-site&#8221; if its target&#8217;s URI&#8217;s origin&#8217;s registrable domain is an exact match for the request&#8217;s initiator&#8217;s &#8220;site for cookies&#8221;, and &#8220;cross-site&#8221; otherwise. To be more precise, for a given request (&#8220;request&#8221;), the following algorithm returns <samp>same-site</samp> or <samp>cross-site</samp>:</p>
<p/>

<ol>
  <li>If <samp>request</samp>&#8217;s client is <samp>null</samp>, return <samp>same-site</samp>.</li>
  <li>Let <samp>site</samp> be <samp>request</samp>&#8217;s client&#8217;s &#8220;site for cookies&#8221; (as defined in the following sections).</li>
  <li>Let <samp>target</samp> be the registrable domain of <samp>request</samp>&#8217;s current url.</li>
  <li>If <samp>site</samp> is an exact match for <samp>target</samp>, return <samp>same-site</samp>.</li>
  <li>Return <samp>cross-site</samp>.</li>
</ol>
<h1 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#document-requests" id="document-requests">Document-based requests</a></h1>
<p id="rfc.section.2.1.1.p.1">The URI displayed in a user agent&#8217;s address bar is the only security context directly exposed to users, and therefore the only signal users can reasonably rely upon to determine whether or not they trust a particular website. The registrable domain of that URI&#8217;s origin represents the context in which a user most likely believes themselves to be interacting. We&#8217;ll label this domain the &#8220;top-level site&#8221;.</p>
<p id="rfc.section.2.1.1.p.2">For a document displayed in a top-level browsing context, we can stop here: the document&#8217;s &#8220;site for cookies&#8221; is the top-level site.</p>
<p id="rfc.section.2.1.1.p.3">For documents which are displayed in nested browsing contexts, we need to audit the origins of each of a document&#8217;s ancestor browsing contexts&#8217; active documents in order to account for the &#8220;multiple-nested scenarios&#8221; described in Section 4 of <a href="#RFC7034">[RFC7034]</a>. These document&#8217;s &#8220;site for cookies&#8221; is the top-level site if and only if the document and each of its ancestor documents&#8217; origins have the same registrable domain as the top-level site. Otherwise its &#8220;site for cookies&#8221; is the empty string.</p>
<p id="rfc.section.2.1.1.p.4">Given a Document (<samp>document</samp>), the following algorithm returns its &#8220;site for cookies&#8221; (either a registrable domain, or the empty string):</p>
<p/>

<ol>
  <li>Let <samp>top-document</samp> be the active document in <samp>document</samp>&#8217;s browsing context&#8217;s top-level browsing context.</li>
  <li>Let <samp>top-origin</samp> be the origin of <samp>top-document</samp>&#8217;s URI if <samp>top-document</samp>&#8217;s sandboxed origin browsing context flag is set, and <samp>top-document</samp>&#8217;s origin otherwise.</li>
  <li>Let <samp>documents</samp> be a list containing <samp>document</samp> and each of <samp>document</samp>&#8217;s ancestor browsing contexts&#8217; active documents.</li>
  <li>For each <samp>item</samp> in <samp>documents</samp>:  <ol><li>Let <samp>origin</samp> be the origin of <samp>item</samp>&#8217;s URI if <samp>item</samp>&#8217;s sandboxed origin browsing context flag is set, and <samp>item</samp>&#8217;s origin otherwise.</li><li>If <samp>origin</samp>&#8217;s host&#8217;s registrable domain is not an exact match for <samp>top-origin</samp>&#8217;s host&#8217;s registrable domain, return the empty string.</li></ol></li>
  <li>Return <samp>top-site</samp>.</li>
</ol>
<h1 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a> <a href="#worker-requests" id="worker-requests">Worker-based requests</a></h1>
<p id="rfc.section.2.1.2.p.1">Worker-driven requests aren&#8217;t as clear-cut as document-driven requests, as there isn&#8217;t a clear link between a top-level browsing context and a worker.  This is especially true for Service Workers <a href="#SERVICE-WORKERS">[SERVICE-WORKERS]</a>, which may execute code in the background, without any document visible at all.</p>
<p id="rfc.section.2.1.2.p.2">Note: The descriptions below assume that workers must be same-origin with the documents that instantiate them. If this invariant changes, we&#8217;ll need to take the worker&#8217;s script&#8217;s URI into account when determining their status.</p>
<h1 id="rfc.section.2.1.2.1"><a href="#rfc.section.2.1.2.1">2.1.2.1.</a> <a href="#dedicated-and-shared-requests" id="dedicated-and-shared-requests">Dedicated and Shared Workers</a></h1>
<p id="rfc.section.2.1.2.1.p.1">Dedicated workers are simple, as each dedicated worker is bound to one and only one document. Requests generated from a dedicated worker (via <samp>importScripts</samp>, <samp>XMLHttpRequest</samp>, <samp>fetch()</samp>, etc) define their &#8220;site for cookies&#8221; as that document&#8217;s &#8220;site for cookies&#8221;.</p>
<p id="rfc.section.2.1.2.1.p.2">Shared workers may be bound to multiple documents at once. As it is quite possible for those documents to have distinct &#8220;site for cookie&#8221; values, the worker&#8217;s &#8220;site for cookies&#8221; will be the empty string in cases where the values diverge, and the shared value in cases where the values agree.</p>
<p id="rfc.section.2.1.2.1.p.3">Given a WorkerGlobalScope (<samp>worker</samp>), the following algorithm returns its &#8220;site for cookies&#8221; (either a registrable domain, or the empty string):</p>
<p/>

<ol>
  <li>Let <samp>site</samp> be <samp>worker</samp>&#8217;s origin&#8217;s host&#8217;s registrable domain.</li>
  <li>For each <samp>document</samp> in <samp>worker</samp>&#8217;s Documents:  <ol><li>Let <samp>document-site</samp> be <samp>document</samp>&#8217;s &#8220;site for cookies&#8221; (as defined in <a href="#document-requests">Section 2.1.1</a>).</li><li>If <samp>document-site</samp> is not an exact match for <samp>site</samp>, return the empty string.</li></ol></li>
  <li>Return <samp>site</samp>.</li>
</ol>
<h1 id="rfc.section.2.1.2.2"><a href="#rfc.section.2.1.2.2">2.1.2.2.</a> <a href="#service-workers" id="service-workers">Service Workers</a></h1>
<p id="rfc.section.2.1.2.2.p.1">Service Workers are more complicated, as they act as a completely separate execution context with only tangential relationship to the Document which registered them.</p>
<p id="rfc.section.2.1.2.2.p.2">Requests which simply pass through a service worker will be handled as described above: the request&#8217;s client will be the Document or Worker which initiated the request, and its &#8220;site for cookies&#8221; will be those defined in <a href="#document-requests">Section 2.1.1</a> and <a href="#dedicated-and-shared-requests">Section 2.1.2.1</a></p>
<p id="rfc.section.2.1.2.2.p.3">Requests which are initiated by the Service Worker itself (via a direct call to <samp>fetch()</samp>, for instance), on the other hand, will have a client which is a ServiceWorkerGlobalScope. Its &#8220;site for cookies&#8221; will be the registrable domain of the Service Worker&#8217;s URI.</p>
<p id="rfc.section.2.1.2.2.p.4">Given a ServiceWorkerGlobalScope (<samp>worker</samp>), the following algorithm returns its &#8220;site for cookies&#8221; (either a registrable domain, or the empty string):</p>
<p/>

<ol>
  <li>Return <samp>worker</samp>&#8217;s origin&#8217;s host&#8217;s registrable domain.</li>
</ol>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#server-requirements" id="server-requirements">Server Requirements</a></h1>
<p id="rfc.section.3.p.1">This section describes extensions to <a href="#RFC6265">[RFC6265]</a> necessary to implement the server-side requirements of the <samp>SameSite</samp> attribute.</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#grammar" id="grammar">Grammar</a></h1>
<p id="rfc.section.3.1.p.1">Add <samp>SameSite</samp> to the list of accepted attributes in the <samp>Set-Cookie</samp> header field&#8217;s value by replacing the <samp>cookie-av</samp> token definition in Section 4.1.1 of <a href="#RFC6265">[RFC6265]</a> with the following ABNF grammar:</p>
<pre>
cookie-av      = expires-av / max-age-av / domain-av /
                 path-av / secure-av / httponly-av /
                 samesite-av / extension-av
samesite-av    = "SameSite" / "SameSite=" samesite-value
samesite-value = "Strict" / "Lax"
</pre>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> <a href="#semantics-of-the-samesite-attribute-non-normative" id="semantics-of-the-samesite-attribute-non-normative">Semantics of the &#8220;SameSite&#8221; Attribute (Non-Normative)</a></h1>
<p id="rfc.section.3.2.p.1">The &#8220;SameSite&#8221; attribute limits the scope of the cookie such that it will only be attached to requests if those requests are &#8220;same-site&#8221;, as defined by the algorithm in <a href="#same-site-requests">Section 2.1</a>. For example, requests for <samp>https://example.com/sekrit-image</samp> will attach same-site cookies if and only if initiated from a context whose &#8220;site for cookies&#8221; is &#8220;example.com&#8221;.</p>
<p id="rfc.section.3.2.p.2">If the &#8220;SameSite&#8221; attribute&#8217;s value is &#8220;Strict&#8221;, or if the value is invalid, the cookie will only be sent along with &#8220;same-site&#8221; requests. If the value is &#8220;Lax&#8221;, the cookie will be sent with &#8220;same-site&#8221; requests, and with &#8220;cross-site&#8221; top-level navigations, as described in <a href="#strict-lax">Section 4.1.1</a>.</p>
<p id="rfc.section.3.2.p.3">The changes to the <samp>Cookie</samp> header field suggested in <a href="#cookie-header">Section 4.3</a> provide additional detail.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#user-agent-requirements" id="user-agent-requirements">User Agent Requirements</a></h1>
<p id="rfc.section.4.p.1">This section describes extensions to <a href="#RFC6265">[RFC6265]</a> necessary in order to implement the client-side requirements of the <samp>SameSite</samp> attribute.</p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#the-samesite-attribute" id="the-samesite-attribute">The &#8220;SameSite&#8221; attribute</a></h1>
<p id="rfc.section.4.1.p.1">The following attribute definition should be considered part of the the <samp>Set-Cookie</samp> algorithm as described in Section 5.2 of <a href="#RFC6265">[RFC6265]</a>:</p>
<p id="rfc.section.4.1.p.2">If the <samp>attribute-name</samp> case-insensitively matches the string &#8220;SameSite&#8221;, the user agent MUST process the <samp>cookie-av</samp> as follows:</p>
<p/>

<ol>
  <li>If <samp>cookie-av</samp>&#8217;s <samp>attribute-value</samp> is not a case-sensitive match for &#8220;Strict&#8221; or &#8220;Lax&#8221;, ignore the <samp>cookie-av</samp>.</li>
  <li>Let <samp>enforcement</samp> be &#8220;Lax&#8221; if <samp>cookie-av</samp>&#8217;s <samp>attribute-value</samp> is a case-insensitive match for &#8220;Lax&#8221;, and &#8220;Strict&#8221; otherwise.</li>
  <li>Append an attribute to the <samp>cookie-attribute-list</samp> with an <samp>attribute-name</samp> of &#8220;SameSite&#8221; and an <samp>attribute-value</samp> of <samp>enforcement</samp>.</li>
</ol>
<h1 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#strict-lax" id="strict-lax">&#8220;Strict&#8221; and &#8220;Lax&#8221; enforcement</a></h1>
<p id="rfc.section.4.1.1.p.1">By default, same-site cookies will not be sent along with top-level navigations.  As discussed in <a href="#top-level-navigations">Section 5.2</a>, this might or might not be compatible with existing session management systems. In the interests of providing a drop-in mechanism that mitigates the risk of CSRF attacks, developers may set the <samp>SameSite</samp> attribute in a &#8220;Lax&#8221; enforcement mode that carves out an exception which sends same-site cookies along with cross-site requests if and only if they are top-level navigations which use a &#8220;safe&#8221; (in the <a href="#RFC7231">[RFC7231]</a> sense) HTTP method.</p>
<p id="rfc.section.4.1.1.p.2">Lax enforcement provides reasonable defense in depth against CSRF attacks that rely on unsafe HTTP methods (like <samp>POST</samp>), but do not offer a robust defense against CSRF as a general category of attack:</p>
<p/>

<ol>
  <li>Attackers can still pop up new windows or trigger top-level navigations in order to create a &#8220;same-site&#8221; request (as described in section 2.1), which is only a speedbump along the road to exploitation.</li>
  <li>Features like <samp>&lt;link rel='prerender'&gt;</samp> <a href="#prerendering">[prerendering]</a> can be exploited to create &#8220;same-site&#8221; requests without the risk of user detection.</li>
</ol>
<p id="rfc.section.4.1.1.p.4">When possible, developers should use a session management mechanism such as that described in <a href="#top-level-navigations">Section 5.2</a> to mitigate the risk of CSRF more completely.</p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#monkey-patching-the-storage-model" id="monkey-patching-the-storage-model">Monkey-patching the Storage Model</a></h1>
<p id="rfc.section.4.2.p.1">Note: There&#8217;s got to be a better way to specify this. Until I figure out what that is, monkey-patching!</p>
<p id="rfc.section.4.2.p.2">Alter Section 5.3 of <a href="#RFC6265">[RFC6265]</a> as follows:</p>
<p/>

<ol>
  <li>Add <samp>samesite-flag</samp> to the list of fields stored for each cookie. This field&#8217;s value is one of &#8220;None&#8221;, &#8220;Strict&#8221;, or &#8220;Lax&#8221;.</li>
  <li>Before step 11 of the current algorithm, add the following:  <ol><li>If the <samp>cookie-attribute-list</samp> contains an attribute with an <samp>attribute-name</samp> of &#8220;SameSite&#8221;, set the cookie&#8217;s <samp>samesite-flag</samp> to <samp>attribute-value</samp> (&#8220;Strict&#8221; or &#8220;Lax&#8221;). Otherwise, set the cookie&#8217;s <samp>samesite-flag</samp> to &#8220;None&#8221;.</li><li>If the cookie&#8217;s <samp>samesite-flag</samp> is not &#8220;None&#8221;, and the request which generated the cookie&#8217;s client&#8217;s &#8220;site for cookies&#8221; is not an exact match for <samp>request-uri</samp>&#8217;s host&#8217;s registrable domain, then abort these steps and ignore the newly created cookie entirely.</li></ol></li>
</ol>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#cookie-header" id="cookie-header">Monkey-patching the &#8220;Cookie&#8221; header</a></h1>
<p id="rfc.section.4.3.p.1">Note: There&#8217;s got to be a better way to specify this. Until I figure out what that is, monkey-patching!</p>
<p id="rfc.section.4.3.p.2">Alter Section 5.4 of <a href="#RFC6265">[RFC6265]</a> as follows:</p>
<p/>

<ol>
  <li>Add the following requirement to the list in step 1:  <ul><li>If the cookie&#8217;s <samp>samesite-flag</samp> is not &#8220;None&#8221;, and the HTTP request is cross-site (as defined in <a href="#same-site-requests">Section 2.1</a> then exclude the cookie unless all of the following statements hold:      <ol><li><samp>samesite-flag</samp> is &#8220;Lax&#8221;</li><li>The HTTP request&#8217;s method is &#8220;safe&#8221;.</li><li>The HTTP request&#8217;s target browsing context is a top-level browsing context.</li></ol></li></ul></li>
</ol>
<p id="rfc.section.4.3.p.4">Note that the modifications suggested here concern themselves only with the &#8220;site for cookies&#8221; of the request&#8217;s client, and the registrable domain of the resource being requested. The cookie&#8217;s <samp>domain</samp>, <samp>path</samp>, and <samp>secure</samp> attributes do not come into play for these comparisons.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#authoring-considerations" id="authoring-considerations">Authoring Considerations</a></h1>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#defense-in-depth" id="defense-in-depth">Defense in depth</a></h1>
<p id="rfc.section.5.1.p.1">&#8220;SameSite&#8221; cookies offer a robust defense against CSRF attack when deployed in strict mode, and when supported by the client. It is, however, prudent to ensure that this designation is not the extent of a site&#8217;s defense against CSRF, as same-site navigations and submissions can certainly be executed in conjunction with other attack vectors such as cross-site scripting.</p>
<p id="rfc.section.5.1.p.2">Developers are strongly encouraged to deploy the usual server-side defenses (CSRF tokens, ensuring that &#8220;safe&#8221; HTTP methods are idempotent, etc) to mitigate the risk more fully.</p>
<p id="rfc.section.5.1.p.3">Additionally, client-side techniques such as those described in <a href="#app-isolation">[app-isolation]</a> may also prove effective against CSRF, and are certainly worth exploring in combination with &#8220;SameSite&#8221; cookies.</p>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#top-level-navigations" id="top-level-navigations">Top-level Navigations</a></h1>
<p id="rfc.section.5.2.p.1">Setting the <samp>SameSite</samp> attribute in &#8220;strict&#8221; mode provides robust defense in depth against CSRF attacks, but has the potential to confuse users unless sites&#8217; developers carefully ensure that their session management systems deal reasonably well with top-level navigations.</p>
<p id="rfc.section.5.2.p.2">Consider the scenario in which a user reads their email at MegaCorp Inc&#8217;s webmail provider <samp>https://example.com/</samp>. They might expect that clicking on an emailed link to <samp>https://projects.com/secret/project</samp> would show them the secret project that they&#8217;re authorized to see, but if <samp>projects.com</samp> has marked their session cookies as <samp>SameSite</samp>, then this cross-site navigation won&#8217;t send them along with the request. <samp>projects.com</samp> will render a 404 error to avoid leaking secret information, and the user will be quite confused.</p>
<p id="rfc.section.5.2.p.3">Developers can avoid this confusion by adopting a session management system that relies on not one, but two cookies: one conceptualy granting &#8220;read&#8221; access, another granting &#8220;write&#8221; access. The latter could be marked as <samp>SameSite</samp>, and its absence would provide a reauthentication step before executing any non-idempotent action. The former could drop the <samp>SameSite</samp> attribute entirely, or choose the &#8220;Lax&#8221; version of enforcement, in order to allow users access to data via top-level navigation.</p>
<h1 id="rfc.section.5.3"><a href="#rfc.section.5.3">5.3.</a> <a href="#mashups-and-widgets" id="mashups-and-widgets">Mashups and Widgets</a></h1>
<p id="rfc.section.5.3.p.1">The <samp>SameSite</samp> attribute is inappropriate for some important use-cases. In particular, note that content intended for embedding in a cross-site contexts (social networking widgets or commenting services, for instance) will not have access to such cookies. Cross-site cookies may be required in order to provide seamless functionality that relies on a user&#8217;s state.</p>
<p id="rfc.section.5.3.p.2">Likewise, some forms of Single-Sign-On might require authentication in a cross-site context; these mechanisms will not function as intended with same-site cookies.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#privacy-considerations" id="privacy-considerations">Privacy Considerations</a></h1>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#server-controlled" id="server-controlled">Server-controlled</a></h1>
<p id="rfc.section.6.1.p.1">Same-site cookies in and of themselves don&#8217;t do anything to address the general privacy concerns outlined in Section 7.1 of <a href="#RFC6265">[RFC6265]</a>. The attribute is set by the server, and serves to mitigate the risk of certain kinds of attacks that the server is worried about. The user is not involved in this decision. Moreover, a number of side-channels exist which could allow a server to link distinct requests even in the absence of cookies. Connection and/or socket pooling, Token Binding, and Channel ID all offer explicit methods of identification that servers could take advantage of.</p>
<h1 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> <a href="#pervasive-monitoring" id="pervasive-monitoring">Pervasive Monitoring</a></h1>
<p id="rfc.section.6.2.p.1">As outlined in <a href="#RFC7258">[RFC7258]</a>, pervasive monitoring is an attack. Cookies play a large part in enabling such monitoring, as they are responsible for maintaining state in HTTP connections. We considered restricting same-site cookies to secure contexts <a href="#secure-contexts">[secure-contexts]</a> as a mitigation but decided against doing so, as this feature should result in a strict reduction in the number of cookies floating around in cross-site contexts. That is, even if <samp>http://not-example.com</samp> embeds a resource from <samp>http://example.com/</samp>, that resource will not be &#8220;same-site&#8221;, and <samp>http://example.com</samp>&#8217;s cookies simply cannot be used to correlate user behavior across distinct origins.</p>
<h1 id="rfc.references"><a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">7.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="FETCH">[FETCH]</b>
      </td>
      <td class="top"><a title="Mozilla">van Kesteren, A.</a>, "<a href="https://fetch.spec.whatwg.org/">Fetch</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="HTML">[HTML]</b>
      </td>
      <td class="top"><a title="Google, Inc.">Hickson, I.</a>, <a title="Opera">Pieters, S.</a>, <a title="Mozilla">van Kesteren, A.</a>, <a title="Opera">J&#228;genstedt, P.</a> and <a title="Google, Inc.">D. Denicola</a>, "<a href="https://html.spec.whatwg.org/">HTML</a>", n.d..</td>
    </tr>
    <tr><td class="reference"><b id="PSL">[PSL]</b></td><td class="top"><a href="https://publicsuffix.org/list/">Public Suffix List</a>", n.d..</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4790">[RFC4790]</b>
      </td>
      <td class="top"><a>Newman, C.</a>, <a>Duerst, M.</a> and <a>A. Gulbrandsen</a>, "<a href="http://tools.ietf.org/html/rfc4790">Internet Application Protocol Collation Registry</a>", RFC 4790, DOI 10.17487/RFC4790, March 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5234">[RFC5234]</b>
      </td>
      <td class="top"><a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, DOI 10.17487/RFC5234, January 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6265">[RFC6265]</b>
      </td>
      <td class="top"><a>Barth, A.</a>, "<a href="http://tools.ietf.org/html/rfc6265">HTTP State Management Mechanism</a>", RFC 6265, DOI 10.17487/RFC6265, April 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6454">[RFC6454]</b>
      </td>
      <td class="top"><a>Barth, A.</a>, "<a href="http://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>", RFC 6454, DOI 10.17487/RFC6454, December 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7231">[RFC7231]</b>
      </td>
      <td class="top"><a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="http://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>", RFC 7231, DOI 10.17487/RFC7231, June 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7258">[RFC7258]</b>
      </td>
      <td class="top"><a>Farrell, S.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc7258">Pervasive Monitoring Is an Attack</a>", BCP 188, RFC 7258, DOI 10.17487/RFC7258, May 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="SERVICE-WORKERS">[SERVICE-WORKERS]</b>
      </td>
      <td class="top"><a>Russell, A.</a>, <a>Song, J.</a> and <a>J. Archibald</a>, <a href="http://www.w3.org/TR/service-workers/">Service Workers</a>", n.d..</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="app-isolation">[app-isolation]</b>
      </td>
      <td class="top"><a>Chen, E.</a>, <a>Bau, J.</a>, <a>Reis, C.</a>, <a>Barth, A.</a> and <a>C. Jackson</a>, "<a href="http://www.collinjackson.com/research/papers/appisolation.pdf">App Isolation - Get the Security of Multiple Browsers with Just One</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="pixel-perfect">[pixel-perfect]</b>
      </td>
      <td class="top"><a>Stone, P.</a>, "<a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">Pixel Perfect Timing Attacks with HTML5</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="prerendering">[prerendering]</b>
      </td>
      <td class="top"><a>Bentzel, C.</a>, "<a href="https://www.chromium.org/developers/design-documents/prerender">Chrome Prerendering</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7034">[RFC7034]</b>
      </td>
      <td class="top"><a>Ross, D.</a> and <a>T. Gondrom</a>, "<a href="http://tools.ietf.org/html/rfc7034">HTTP Header Field X-Frame-Options</a>", RFC 7034, DOI 10.17487/RFC7034, October 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="samedomain-cookies">[samedomain-cookies]</b>
      </td>
      <td class="top"><a>Goodwin, M.</a> and <a>J. Walker</a>, "<a href="http://people.mozilla.org/~mgoodwin/SameDomain/samedomain-latest.txt">SameDomain Cookie Flag</a>", 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="secure-contexts">[secure-contexts]</b>
      </td>
      <td class="top"><a>West, M.</a>, "<a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Contexts</a>", n.d..</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.A.p.1">The same-site cookie concept documented here is indebited to Mark Goodwin&#8217;s and Joe Walker&#8217;s <a href="#samedomain-cookies">[samedomain-cookies]</a>. Michal Zalewski, Artur Janc, Ryan Sleevi, and Adam Barth provided particularly valuable feedback on this document.</p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mike West</span> 
	  <span class="n hidden">
		<span class="family-name">West</span>
	  </span>
	</span>
	<span class="org vcardline">Google, Inc</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mkwst@google.com">mkwst@google.com</a></span>

<span class="vcardline">URI: <a href="https://mikewest.org/">https://mikewest.org/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mark Goodwin</span> 
	  <span class="n hidden">
		<span class="family-name">Goodwin</span>
	  </span>
	</span>
	<span class="org vcardline">Mozilla</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mgoodwin@mozilla.com">mgoodwin@mozilla.com</a></span>

<span class="vcardline">URI: <a href="https://www.computerist.org/">https://www.computerist.org/</a></span>

  </address>
</div>

</body>
</html>
